---
title: "jterm_project2"
author: "Kent Williams"
date: "1/11/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(tidytext)
library(ggwordcloud)
library(textdata)
```

# Analysis for New York and Tampa Bay
```{r, echo=FALSE, warning = FALSE, include=FALSE}
NY_times <- tibble(text = read_lines("nyt_2020_compiled"))

NYT_Words <-  NY_times %>% unnest_tokens(word, text)
NYT_SW <- NYT_Words %>% anti_join(stop_words)
NYT_Count <- NYT_SW %>% count(word, sort=TRUE)


TB_times <- tibble(text = read_lines("tampa20compiled"))

TB_Words <-  TB_times %>% unnest_tokens(word, text)
TB_SW <- TB_Words %>% anti_join(stop_words)
TB_Count <- TB_SW %>% count(word, sort=TRUE)

TB2_times <- tibble(text = read_lines("tampa2021compiled"))

TB2_Words <-  TB2_times %>% unnest_tokens(word, text)
TB2_SW <- TB2_Words %>% anti_join(stop_words)
TB2_Count <- TB2_SW %>% count(word, sort=TRUE)
```

Top 6 Words (Excluding Stop Words)
```{r, echo=FALSE, warning = FALSE, include=FALSE}
# Count of Each Word
NW_WordCount <- NY_times %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words) %>% 
  count(word, sort = TRUE)
```

```{r, echo=FALSE, warning = FALSE}
# Display Word Count
  # Makes sense that "covid" is the most frequent...
head(NW_WordCount)
```

## Sentiment Analysis for NYT and TBT
```{r, echo=FALSE, warning = FALSE, include=FALSE}
NYTSentiment_affin <- NYT_Words %>%
  inner_join(get_sentiments("afinn"))

NYTSentiment_nrc <- NYT_Words %>%
  inner_join(get_sentiments("nrc"))

NYTSentiment_bing <- NYT_Words %>%
  inner_join(get_sentiments("bing"))

table(NYTSentiment_bing$sentiment)
table(NYTSentiment_nrc$sentiment)

###### tampa analysis
TBTSentiment_afinn <- TB_Words %>%
  inner_join(get_sentiments("afinn"))

TBTSentiment_nrc <- TB_Words %>%
  inner_join(get_sentiments("nrc"))

TBTSentiment_bing <- TB_Words %>%
  inner_join(get_sentiments("bing"))

table(TBTSentiment_bing$sentiment)
table(TBTSentiment_nrc$sentiment)
table(TBTSentiment_afinn$value)

TBT2Sentiment_afinn <- TB2_Words %>%
  inner_join(get_sentiments("afinn"))

TBT2Sentiment_nrc <- TB2_Words %>%
  inner_join(get_sentiments("nrc"))

TBT2Sentiment_bing <- TB2_Words %>%
  inner_join(get_sentiments("bing"))

table(TBT2Sentiment_bing$sentiment)
table(TBT2Sentiment_nrc$sentiment)
table(TBT2Sentiment_afinn$value)

```

```{r, echo=FALSE, warning = FALSE}
(ggplot(data = NYTSentiment_affin, 
       aes(x=value))+
  geom_histogram()+
  ggtitle("NY Times Covid Sentiment Range")+
  theme_minimal())

(ggplot(data = TBTSentiment_afinn, 
       aes(x=value))+
  geom_histogram()+
  ggtitle("Tampa Bay Times Covid Sentiment Range")+
  theme_minimal())

(ggplot(data = TBT2Sentiment_afinn, 
       aes(x=value))+
  geom_histogram()+
  ggtitle("Tampa Bay Times Covid Sentiment Range")+
  theme_minimal())
```
```
